<main class="dashboard-wrapper">
  
  <header class="dash-header">
    <h1>Controle Financeiro ğŸ’°</h1>
    <div class="date-picker">
      <input type="month" [(ngModel)]="mesAnoSelecionado" (ngModelChange)="filtrarPorMes()">
    </div>
  </header>

  <section class="kpi-grid">
    <div class="kpi-card receita">
      <span class="kpi-label">Receitas</span>
      <h3 class="kpi-value">{{ totalReceitas | currency:'BRL' }}</h3>
    </div>
    <div class="kpi-card despesa">
      <span class="kpi-label">Despesas</span>
      <h3 class="kpi-value">{{ totalDespesas | currency:'BRL' }}</h3>
    </div>
    <div class="kpi-card saldo">
      <span class="kpi-label">Saldo Atual</span>
      <h3 class="kpi-value">{{ saldoGeral | currency:'BRL' }}</h3>
    </div>
  </section>

  <div class="grid-main">
    <div class="chart-container">
      <h3>ğŸ• Despesas por Categoria</h3>
      <div class="canvas-box">
        <canvas id="canvasCategorias"></canvas>
      </div>
    </div>

    <div class="action-column">
      <div class="form-card">
        <h3>Novo LanÃ§amento</h3>
        <input type="text" placeholder="DescriÃ§Ã£o" [(ngModel)]="novaTransacao.descricao">
        <div class="row">
          <input type="number" placeholder="Valor" [(ngModel)]="novaTransacao.valor">
          <select [(ngModel)]="novaTransacao.tipo">
            <option value="despesa">Despesa</option>
            <option value="receita">Receita</option>
          </select>
        </div>
        <button (click)="adicionarTransacao()" class="btn-add">Salvar</button>
      </div>
    </div>
  </div>

  <section class="list-section">
    <div class="list-header">
      <h3>ğŸ“‹ LanÃ§amentos</h3>
      <select [(ngModel)]="categoriaSelecionada" (ngModelChange)="mudarCategoria()">
        <option value="Todas">Todas</option>
        @for (cat of categoriasDisponiveis; track cat) { <option [value]="cat">{{ cat }}</option> }
      </select>
    </div>

    <div class="transaction-stack">
      @for (t of transacoesFiltradas; track t.id) {
        <div class="t-card" [class.t-receita]="t.tipo === 'receita'" [class.t-despesa]="t.tipo === 'despesa'">
          <div class="t-main">
            <span class="t-desc">{{ t.descricao }}</span>
            <small class="t-meta">{{ t.data_transacao | date:'dd/MM' }} â€¢ {{ t.categoria }}</small>
          </div>
          <div class="t-right">
            <span class="t-amount" [class.txt-receita]="t.tipo === 'receita'">
              {{ t.tipo === 'despesa' ? '-' : '+' }} {{ t.valor | currency:'BRL' }}
            </span>
            <button (click)="excluirTransacao(t.id)" class="btn-del">ğŸ—‘ï¸</button>
          </div>
        </div>
      }
    </div>
  </section>
</main>